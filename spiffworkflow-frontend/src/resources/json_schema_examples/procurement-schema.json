{
  "definitions": {
    "projectEnum": {
      "title": "Project",
      "type": "string",
      "anyOf": [
        "options_from_task_data_var:dept_enum_list"
      ]
    },
    "categoryEnum": {
      "title": "Category",
      "type": "string",
      "anyOf": [
        "options_from_task_data_var:category_enum_list"
      ]
    },
    "pay_methodEnum": {
      "title": "Payment Method",
      "type": "string",
      "anyOf": [
        "options_from_task_data_var:pay_method_enum_list"
      ]
    },
    "currencyEnum": {
      "title": "Currency",
      "type": "string",
      "anyOf": [
        "options_from_task_data_var:currency_enum_list"
      ]
    },
    "currency_typeEnum": {
      "title": "Currency",
      "type": "string",
      "anyOf": [
        "options_from_task_data_var:currency_type_enum_list"
      ]
    },
    "soft_lic_sub_categoryEnum": {
      "title": "Sub-Category",
      "type": "string",
      "anyOf": [
        "options_from_task_data_var:soft_lic_sub_category_enum_list"
      ]
    },
    "equip_sub_categoryEnum": {
      "title": "Sub-Category",
      "type": "string",
      "anyOf": [
        "options_from_task_data_var:equip_sub_category_enum_list"
      ]
    },
    "learn_dev_sub_categoryEnum": {
      "title": "Sub-Category",
      "type": "string",
      "anyOf": [
        "options_from_task_data_var:learn_dev_sub_category_enum_list"
      ]
    },
    "consult_fees_sub_categoryEnum": {
      "title": "Sub-Category",
      "type": "string",
      "anyOf": [
        "options_from_task_data_var:consult_fees_sub_category_enum_list"
      ]
    },
    "other_fees_sub_categoryEnum": {
      "title": "Sub-Category",
      "type": "string",
      "anyOf": [
        "options_from_task_data_var:other_fees_sub_category_enum_list"
      ]
    }
  },
  "properties": {
    "ndr_details": {
      "type": "object",
      "required": [
        "core_contributor",
        "project",
        "category",
        "purpose",
        "criticality",
        "period",
        "item"
      ],
      "title": "Request Goods/Services",
      "description": "Submit a new request for the procurement of needed items. Does not include Travel or Compensation.",
      "properties": {
        "requestor": {
          "type": "string",
          "title": "Requestor",
          "readOnly": true
        },
        "core_contributor": {
          "type": "string",
          "title": "Core Contributor",
          "validationErrorMessage": "Please select a contributor from the dropdown"
        },
        "project": {
          "$ref": "#/definitions/projectEnum",
          "title": "Project"
        },
        "category": {
          "$ref": "#/definitions/categoryEnum",
          "title": "Category"
        },
        "purpose": {
          "maxLength": 250,
          "type": "string",
          "title": "Purpose",
          "description": "Short description"
        },
        "criticality": {
          "type": "string",
          "title": " Criticality",
          "enum": [
            "High",
            "Medium",
            "Low"
          ]
        },
        "vendor": {
          "type": "string",
          "title": "Vendor"
        },
        "period": {
          "type": "string",
          "format": "date",
          "title": "Preferred Delivery Date",
          "validationErrorMessage": "Date must be today's date or later"
        },
        "payment_method": {
          "$ref": "#/definitions/pay_methodEnum",
          "title": "Payment method"
        },
        "item": {
          "type": "array",
          "title": "Please specify the goods or services you need",
          "minItems": 1,
          "items": {
            "type": "object",
            "title": "Item information",
            "required": [
              "sub_category",
              "item_name",
              "qty",
              "currency_type",
              "currency",
              "unit_price"
            ],
            "properties": {
              "item_name": {
                "type": "string",
                "title": "Name",
                "maxLength": 100
              },
              "item_url": {
                "type": "string",
                "title": "Item URL",
                "format": "url",
                "validationErrorMessage": "Item URL must match format https://www.example.url/"
              },
              "qty": {
                "type": "number",
                "title": "Qty",
                "minimum": 1
              },
              "currency_type": {
                "$ref": "#/definitions/currency_typeEnum",
                "title": "Currency Type",
                "validationErrorMessage": "Must be equal to one of the allowed values. The Currency and Unit Price fields are dependent on selected value"
              }
            },
            "dependencies": {
              "currency_type": {
                "oneOf": [{
                  "properties": {
                    "currency_type": {
                      "enum": [
                        "crypto"
                      ]
                    },
                    "currency": {
                      "title": "Crypto Currency",
                      "type": "string",
                      "enum": [
                        "ETH",
                        "DAI",
                        "SNT"
                      ],
                      "validationErrorMessage": "Must be equal to one of the allowed values. The Unit Price field is dependent on selected value"
                    },
                    "unit_price": {
                      "type": "string",
                      "title": "Unit Price",
                      "pattern": "^(\\d{1,3}(,?\\d{3})*)(\\.\\d{0,4})?$",
                      "validationErrorMessage": "Must have no commas or commas every 3 places, period for separator, 0 to 4 numbers after separator"
                    }
                  },
                  "required": [
                    "currency"
                  ]
                },
                  {
                    "properties": {
                      "currency_type": {
                        "enum": [
                          "fiat"
                        ]
                      },
                      "currency": {
                        "$ref": "#/definitions/currencyEnum",
                        "title": "Fiat Currency",
                        "validationErrorMessage": "Must be equal to one of the allowed values. The Unit Price field is dependent on selected value"
                      },
                      "unit_price": {
                        "type": "string",
                        "title": "Unit Price",
                        "pattern": "^(\\d{1,3}(,?\\d{3})*)(\\.\\d\\d)?$",
                        "validationErrorMessage": "Must have no commas or commas every 3 places, period for separator, 0 or 2 numbers after separator"
                      }
                    }
                  }
                ]
              }
            }
          }
        }
      },
      "dependencies": {
        "category": {
          "oneOf": [
            {
              "properties": {
                "category": {
                  "enum": [
                    "soft_and_lic"
                  ]
                },
                "item": {
                  "items": {
                    "properties": {
                      "sub_category": {
                        "$ref": "#/definitions/soft_lic_sub_categoryEnum",
                        "title": "Sub Category"
                      }
                    }
                  }
                }
              }
            },
            {
              "properties": {
                "category": {
                  "enum": [
                    "equip"
                  ]
                },
                "item": {
                  "items": {
                    "properties": {
                      "sub_category": {
                        "$ref": "#/definitions/equip_sub_categoryEnum",
                        "title": "Sub Category"
                      }
                    }
                  }
                }
              }
            },
            {
              "properties": {
                "category": {
                  "enum": [
                    "learn_and_dev"
                  ]
                },
                "item": {
                  "items": {
                    "properties": {
                      "sub_category": {
                        "$ref": "#/definitions/learn_dev_sub_categoryEnum",
                        "title": "Sub Category"
                      }
                    }
                  }
                }
              }
            },
            {
              "properties": {
                "category": {
                  "enum": [
                    "consult_fees"
                  ]
                },
                "item": {
                  "items": {
                    "properties": {
                      "sub_category": {
                        "$ref": "#/definitions/consult_fees_sub_categoryEnum",
                        "title": "Sub Category"
                      }
                    }
                  }
                }
              }
            },
            {
              "properties": {
                "category": {
                  "enum": [
                    "other_fees"
                  ]
                },
                "item": {
                  "items": {
                    "properties": {
                      "sub_category": {
                        "$ref": "#/definitions/other_fees_sub_categoryEnum",
                        "title": "Sub Category"
                      }
                    }
                  }
                }
              }
            }
          ]
        }
      }
    }
  }
}